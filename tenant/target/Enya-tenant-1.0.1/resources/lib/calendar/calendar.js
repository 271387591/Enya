Calendar=function(){function aS(b){typeof b=="string"&&(b=document.getElementById(b));return b;}function aW(e,d,f){for(f=0;f<e.length;++f){d(e[f]);}}function aY(){var d=document.documentElement,c=document.body;return{x:d.scrollLeft||c.scrollLeft,y:d.scrollTop||c.scrollTop,w:d.clientWidth||window.innerWidth||c.clientWidth,h:d.clientHeight||window.innerHeight||c.clientHeight};}function a0(h){var g=0,l=0,k=/^div$/i.test(h.tagName),j,i;k&&h.scrollLeft&&(g=h.scrollLeft),k&&h.scrollTop&&(l=h.scrollTop),j={x:h.offsetLeft-g,y:h.offsetTop-l},h.offsetParent&&(i=a0(h.offsetParent),j.x+=i.x,j.y+=i.y);return j;}function a2(f,e){var h=a3?f.clientX+document.body.scrollLeft:f.pageX,g=a3?f.clientY+document.body.scrollTop:f.pageY;e&&(h-=e.x,g-=e.y);return{x:h,y:g};}function a4(e,d){var f=e.style;d!=null&&(f.display=d?"":"none");return f.display!="none";}function a6(d,c){c===""?a3?d.style.filter="":d.style.opacity="":c!=null?a3?d.style.filter="alpha(opacity="+c*100+")":d.style.opacity=c:a3?/alpha\(opacity=([0-9.])+\)/.test(d.style.opacity)&&(c=parseFloat(RegExp.$1)/100):c=parseFloat(d.style.opacity);return c;}function bn(i,e,n){function j(){var a=i.len;i.onUpdate(n/a,m),n==a&&k(),++n;}function k(){e&&(clearInterval(e),e=null),i.onStop(n/i.len,m);}function l(){e&&k(),n=0,e=setInterval(j,1000/i.fps);}function m(g,f,o,h){return h?o+g*(f-o):f+g*(o-f);}i=af(i,{fps:50,len:15,onUpdate:aT,onStop:aT}),a3&&(i.len=Math.round(i.len/2)),l();return{start:l,stop:k,update:j,args:i,map:m};}function bp(e,d){if(!d(e)){for(var f=e.firstChild;f;f=f.nextSibling){f.nodeType==1&&bp(f,d);}}}function bq(e,d){var f=bs(arguments,2);return d==undefined?function(){return e.apply(this,f.concat(bs(arguments)));}:function(){return e.apply(d,f.concat(bs(arguments)));};}function bs(h,g){g==null&&(g=0);var l,k,j;try{l=Array.prototype.slice.call(h,g);}catch(i){l=Array(h.length-g);for(k=g,j=0;k<h.length;++k,++j){l[j]=h[k];}}return l;}function br(f,e,h){var g=null;document.createElementNS?g=document.createElementNS("http://www.w3.org/1999/xhtml",f):g=document.createElement(f),e&&(g.className=e),h&&h.appendChild(g);return g;}function aB(f,e,h){if(e instanceof Array){for(var g=e.length;--g>=0;){aB(f,e[g],h);}}else{ab(e,h,f?h:null);}return f;}function aa(d,c){return ab(d,c,c);}function ab(h,g,l){if(h){var k=h.className.replace(/^\s+|\s+$/,"").split(/\x20/),j=[],i;for(i=k.length;i>0;){k[--i]!=g&&j.push(k[i]);}l&&j.push(l),h.className=j.join(" ");}return l;}function ac(b){b=b||window.event,a3?(b.cancelBubble=!0,b.returnValue=!1):(b.preventDefault(),b.stopPropagation());return !1;}function ad(g,e,j,i){if(g instanceof Array){for(var h=g.length;--h>=0;){ad(g[h],e,j);}}else{if(typeof e=="object"){for(var h in e){e.hasOwnProperty(h)&&ad(g,h,e[h],j);}}else{g.removeEventListener?g.removeEventListener(e,j,a3?!0:!!i):g.detachEvent?g.detachEvent("on"+e,j):g["on"+e]=null;}}}function ae(g,e,j,i){if(g instanceof Array){for(var h=g.length;--h>=0;){ae(g[h],e,j,i);}}else{if(typeof e=="object"){for(var h in e){e.hasOwnProperty(h)&&ae(g,h,e[h],j);}}else{g.addEventListener?g.addEventListener(e,j,a3?!0:!!i):g.attachEvent?g.attachEvent("on"+e,j):g["on"+e]=j;}}}function af(f,e,h,g){g={};for(h in e){e.hasOwnProperty(h)&&(g[h]=e[h]);}for(h in f){f.hasOwnProperty(h)&&(g[h]=f[h]);}return g;}function ag(d){if(/\S/.test(d)){d=d.toLowerCase();function c(a){for(var e=a.length;--e>=0;){if(a[e].toLowerCase().indexOf(d)==0){return e+1;}}}return c(ao("smn"))||c(ao("mn"));}}function ah(d){if(d){if(typeof d=="number"){return ak(d);}if(!(d instanceof Date)){var c=d.split(/-/);return new Date(parseInt(c[0],10),parseInt(c[1],10)-1,parseInt(c[2],10),12,0,0,0);}}return d;}function ai(D,C){var B=D.getMonth(),A=D.getDate(),z=D.getFullYear(),y=an(D),x=D.getDay(),w=D.getHours(),v=w>=12,u=v?w-12:w,t=am(D),s=D.getMinutes(),r=D.getSeconds(),q=/%./g,p;u===0&&(u=12),p={"%a":ao("sdn")[x],"%A":ao("dn")[x],"%b":ao("smn")[B],"%B":ao("mn")[B],"%C":1+Math.floor(z/100),"%d":A<10?"0"+A:A,"%e":A,"%H":w<10?"0"+w:w,"%I":u<10?"0"+u:u,"%j":t<10?"00"+t:t<100?"0"+t:t,"%k":w,"%l":u,"%m":B<9?"0"+(1+B):1+B,"%o":1+B,"%M":s<10?"0"+s:s,"%n":"\n","%p":v?"PM":"AM","%P":v?"pm":"am","%s":Math.floor(D.getTime()/1000),"%S":r<10?"0"+r:r,"%t":"\t","%U":y<10?"0"+y:y,"%W":y<10?"0"+y:y,"%V":y<10?"0"+y:y,"%u":x+1,"%w":x,"%y":(""+z).substr(2,2),"%Y":z,"%%":"%"};return C.replace(q,function(b){return p.hasOwnProperty(b)?p[b]:b;});}function aj(r,q,p){var o=r.getFullYear(),n=r.getMonth(),m=r.getDate(),l=q.getFullYear(),k=q.getMonth(),j=q.getDate();return o<l?-3:o>l?3:n<k?-2:n>k?2:p?0:m<j?-1:m>j?1:0;}function ak(i,h,n,m,l){if(!(i instanceof Date)){i=parseInt(i,10);var k=Math.floor(i/10000);i=i%10000;var j=Math.floor(i/100);i=i%100,i=new Date(k,j-1,i,h==null?12:h,n==null?0:n,m==null?0:m,l==null?0:l);}return i;}function al(b){if(b instanceof Date){return 10000*b.getFullYear()+100*(b.getMonth()+1)+b.getDate();}if(typeof b=="string"){return parseInt(b,10);}return b;}function am(e){e=new Date(e.getFullYear(),e.getMonth(),e.getDate(),12,0,0);var d=new Date(e.getFullYear(),0,1,12,0,0),f=e-d;return Math.floor(f/86400000);}function an(e){e=new Date(e.getFullYear(),e.getMonth(),e.getDate(),12,0,0);var d=e.getDay();e.setDate(e.getDate()-(d+6)%7+3);var f=e.valueOf();e.setMonth(0),e.setDate(4);return Math.round((f-e.valueOf())/604800000)+1;}function ao(e,d){var f=aV.__.data[e];d&&typeof f=="string"&&(f=ap(f,d));return f;}function ap(d,c){return d.replace(/\$\{([^:\}]+)(:[^\}]+)?\}/g,function(b,j,i){var h=c[j],g;i&&(g=i.substr(1).split(/\s*\|\s*/),h=(h>=g.length?g[g.length-1]:g[h]).replace(/##?/g,function(e){return e.length==2?"#":h;}));return h;});}function aq(B){if(!this._menuAnim){B=B||window.event;var A=B.target||B.srcElement,z=A.getAttribute("dyc-btn"),y=B.keyCode,x=B.charCode||y,w=at[y];if("year"==z&&y==13){var v=new Date(this.date);v.setDate(1),v.setFullYear(this._getInputYear()),this.moveTo(v,!0),aC(this,!1);return ac(B);}if(this._menuVisible){if(y==27){aC(this,!1);return ac(B);}}else{B.ctrlKey||(w=null),w==null&&!B.ctrlKey&&(w=ar[y]),y==36&&(w=0);if(w!=null){aD(this,w);return ac(B);}x=String.fromCharCode(x).toLowerCase();var u=this.els.yearInput,t=this.selection;if(x==" "){aC(this,!0),this.focus(),u.focus(),u.select();return ac(B);}if(x>="0"&&x<="9"){aC(this,!0),this.focus(),u.value=x,u.focus();return ac(B);}var s=ao("mn"),r=B.shiftKey?-1:this.date.getMonth(),q=0,p;while(++q<12){p=s[(r+q)%12].toLowerCase();if(p.indexOf(x)==0){var v=new Date(this.date);v.setDate(1),v.setMonth((r+q)%12),this.moveTo(v,!0);return ac(B);}}if(y>=37&&y<=40){var v=this._lastHoverDate;if(!v&&!t.isEmpty()){v=y<39?t.getFirstDate():t.getLastDate();if(v<this._firstDateVisible||v>this._lastDateVisible){v=null;}}if(!v){v=y<39?this._lastDateVisible:this._firstDateVisible;}else{var a=v;v=ak(v);var r=100;while(r-->0){switch(y){case 37:v.setDate(v.getDate()-1);break;case 38:v.setDate(v.getDate()-7);break;case 39:v.setDate(v.getDate()+1);break;case 40:v.setDate(v.getDate()+7);}if(!this.isDisabled(v)){break;}}v=al(v),(v<this._firstDateVisible||v>this._lastDateVisible)&&this.moveTo(v);}ab(this._getDateDiv(a),aa(this._getDateDiv(v),"DynarchCalendar-hover-date")),this._lastHoverDate=v;return ac(B);}if(y==13&&this._lastHoverDate){t.type==bo.SEL_MULTIPLE&&(B.shiftKey||B.ctrlKey)?(B.shiftKey&&this._selRangeStart&&(t.clear(!0),t.selectRange(this._selRangeStart,this._lastHoverDate)),B.ctrlKey&&t.set(this._selRangeStart=this._lastHoverDate,!0)):t.reset(this._selRangeStart=this._lastHoverDate);return ac(B);}y==27&&!this.args.cont&&this.hide();}}}function au(){this.refresh();var e=this.inputField,d=this.selection;if(e){var f=d.print(this.dateFormat);/input|textarea/i.test(e.tagName)?e.value=f:e.innerHTML=f;}this.callHooks("onSelect",this,d);}function av(g){g=g||window.event;var f=ay(g);if(f){var j=f.getAttribute("dyc-btn"),i=f.getAttribute("dyc-type"),h=g.wheelDelta?g.wheelDelta/120:-g.detail/3;h=h<0?-1:h>0?1:0,this.args.reverseWheel&&(h=-h);if(/^(time-(hour|min))/.test(i)){switch(RegExp.$1){case"time-hour":this.setHours(this.getHours()+h);break;case"time-min":this.setMinutes(this.getMinutes()+this.args.minuteStep*h);}ac(g);}else{/Y/i.test(j)&&(h*=2),aD(this,-h),ac(g);}}}function aw(g,f){f=f||window.event;var j=ay(f);if(j){var i=j.getAttribute("dyc-type");if(i&&!j.getAttribute("disabled")){if(!g||!this._bodyAnim||i!="date"){var h=j.getAttribute("dyc-cls");h=h?ax(h,0):"DynarchCalendar-hover-"+i,(i!="date"||this.selection.type)&&aB(g,j,h),i=="date"&&(aB(g,j.parentNode.parentNode,"DynarchCalendar-hover-week"),this._showTooltip(j.getAttribute("dyc-date"))),/^time-hour/.test(i)&&aB(g,this.els.timeHour,"DynarchCalendar-hover-time"),/^time-min/.test(i)&&aB(g,this.els.timeMinute,"DynarchCalendar-hover-time"),ab(this._getDateDiv(this._lastHoverDate),"DynarchCalendar-hover-date"),this._lastHoverDate=null;}}}g||this._showTooltip();}function ax(d,c){return"DynarchCalendar-"+d.split(/,/)[c];}function ay(e){var d=e.target||e.srcElement,f=d;while(d&&d.getAttribute&&!d.getAttribute("dyc-type")){d=d.parentNode;}return d.getAttribute&&d||f;}function az(e){e=e||window.event;var d=this.els.topCont.style,f=a2(e,this._mouseDiff);d.left=f.x+"px",d.top=f.y+"px";}function aA(v,u){u=u||window.event;var t=ay(u);if(t&&!t.getAttribute("disabled")){var s=t.getAttribute("dyc-btn"),r=t.getAttribute("dyc-type"),q=t.getAttribute("dyc-date"),p=this.selection,o,n={mouseover:ac,mousemove:ac,mouseup:function(d){var c=t.getAttribute("dyc-cls");c&&ab(t,ax(c,1)),clearTimeout(o),ad(document,n,!0),n=null;}};if(v){setTimeout(bq(this.focus,this),1);var e=t.getAttribute("dyc-cls");e&&aa(t,ax(e,1));if("menu"==s){this.toggleMenu();}else{if(t&&/^[+-][MY]$/.test(s)){if(aD(this,s)){var a=bq(function(){aD(this,s,!0)?o=setTimeout(a,40):(n.mouseup(),aD(this,s));},this);o=setTimeout(a,350),ae(document,n,!0);}else{n.mouseup();}}else{if("year"==s){this.els.yearInput.focus(),this.els.yearInput.select();}else{if(r=="time-am"){ae(document,n,!0);}else{if(/^time/.test(r)){var a=bq(function(b){aF.call(this,b),o=setTimeout(a,100);},this,r);aF.call(this,r),o=setTimeout(a,350),ae(document,n,!0);}else{q&&p.type&&(p.type==bo.SEL_MULTIPLE?u.shiftKey&&this._selRangeStart?p.selectRange(this._selRangeStart,q):(!u.ctrlKey&&!p.isSelected(q)&&p.clear(!0),p.set(q,!0),this._selRangeStart=q):(p.set(q),this.moveTo(ak(q),2)),t=this._getDateDiv(q),aw.call(this,!0,{target:t})),ae(document,n,!0);}}}}}a3&&n&&/dbl/i.test(u.type)&&n.mouseup(),!this.args.fixed&&/^(DynarchCalendar-(topBar|bottomBar|weekend|weekNumber|menu(-sep)?))?$/.test(t.className)&&!this.args.cont&&(n.mousemove=bq(az,this),this._mouseDiff=a2(u,a0(this.els.topCont)),ae(document,n,!0));}else{if("today"==s){!this._menuVisible&&p.type==bo.SEL_SINGLE&&p.set(new Date),this.moveTo(new Date,!0),aC(this,!1);}else{if(/^m([0-9]+)/.test(s)){var q=new Date(this.date);q.setDate(1),q.setMonth(RegExp.$1),q.setFullYear(this._getInputYear()),this.moveTo(q,!0),aC(this,!1);}else{r=="time-am"&&this.setHours(this.getHours()+12);}}}a3||ac(u);}}function aC(f,e){f._menuVisible=e,aB(e,f.els.title,"DynarchCalendar-pressed-title");var h=f.els.menu;a1&&(h.style.height=f.els.main.offsetHeight+"px");if(!f.args.animation){a4(h,e),f.focused&&f.focus();}else{f._menuAnim&&f._menuAnim.stop();var g=f.els.main.offsetHeight;a1&&(h.style.width=f.els.topBar.offsetWidth+"px"),e&&(h.firstChild.style.marginTop=-g+"px",f.args.opacity>0&&a6(h,0),a4(h,!0)),f._menuAnim=bn({onUpdate:function(b,a){h.firstChild.style.marginTop=a(a7.accel_b(b),-g,0,!e)+"px",f.args.opacity>0&&a6(h,a(a7.accel_b(b),0,0.85,!e));},onStop:function(){f.args.opacity>0&&a6(h,0.85),h.firstChild.style.marginTop="",f._menuAnim=null,e||(a4(h,!1),f.focused&&f.focus());}});}}function aD(f,e,h){this._bodyAnim&&this._bodyAnim.stop();var g;if(e!=0){g=new Date(f.date),g.setDate(1);switch(e){case"-Y":case -2:g.setFullYear(g.getFullYear()-1);break;case"+Y":case 2:g.setFullYear(g.getFullYear()+1);break;case"-M":case -1:g.setMonth(g.getMonth()-1);break;case"+M":case 1:g.setMonth(g.getMonth()+1);}}else{g=new Date;}return f.moveTo(g,!h);}function aF(b){switch(b){case"time-hour+":this.setHours(this.getHours()+1);break;case"time-hour-":this.setHours(this.getHours()-1);break;case"time-min+":this.setMinutes(this.getMinutes()+this.args.minuteStep);break;case"time-min-":this.setMinutes(this.getMinutes()-this.args.minuteStep);break;default:return;}}function aG(){this._bluringTimeout=setTimeout(bq(aH,this),50);}function aH(){this.focused=!1,ab(this.els.main,"DynarchCalendar-focused"),this._menuVisible&&aC(this,!1),this.args.cont||this.hide(),this.callHooks("onBlur",this);}function aI(){this._bluringTimeout&&clearTimeout(this._bluringTimeout),this.focused=!0,aa(this.els.main,"DynarchCalendar-focused"),this.callHooks("onFocus",this);}function aJ(f){var e=br("div"),h=f.els={},g={mousedown:bq(aA,f,!0),mouseup:bq(aA,f,!1),mouseover:bq(aw,f,!0),mouseout:bq(aw,f,!1),keypress:bq(aq,f)};f.args.noScroll||(g[aZ?"DOMMouseScroll":"mousewheel"]=bq(av,f)),a3&&(g.dblclick=g.mousedown,g.keydown=g.keypress),e.innerHTML=aP(f),bp(e.firstChild,function(d){var c=aK[d.className];c&&(h[c]=d),a3&&d.setAttribute("unselectable","on");}),ae(h.main,g),ae([h.focusLink,h.yearInput],f._focusEvents={focus:bq(aI,f),blur:bq(aG,f)}),f.moveTo(f.date,!1),f.setTime(null,!0);return h.topCont;}function aL(f){function g(){h.showTime&&(e.push("<td>"),aM(f,e),e.push("</td>"));}var e=[],h=f.args;e.push("<table",aU," style='width:100%'><tr>"),h.timePos=="left"&&g(),h.bottomBar&&(e.push("<td>"),e.push("<table",aU,"><tr><td>","<div dyc-btn='today' dyc-cls='hover-bottomBar-today,pressed-bottomBar-today' dyc-type='bottomBar-today' ","class='DynarchCalendar-bottomBar-today'>",ao("today"),"</div>","</td></tr></table>"),e.push("</td>")),h.timePos=="right"&&g(),e.push("</tr></table>");return e.join("");}function aM(d,c){c.push("<table class='DynarchCalendar-time'"+aU+"><tr>","<td rowspan='2'><div dyc-type='time-hour' dyc-cls='hover-time,pressed-time' class='DynarchCalendar-time-hour'></div></td>","<td dyc-type='time-hour+' dyc-cls='hover-time,pressed-time' class='DynarchCalendar-time-up'></td>","<td rowspan='2' class='DynarchCalendar-time-sep'></td>","<td rowspan='2'><div dyc-type='time-min' dyc-cls='hover-time,pressed-time' class='DynarchCalendar-time-minute'></div></td>","<td dyc-type='time-min+' dyc-cls='hover-time,pressed-time' class='DynarchCalendar-time-up'></td>"),d.args.showTime==12&&c.push("<td rowspan='2' class='DynarchCalendar-time-sep'></td>","<td rowspan='2'><div class='DynarchCalendar-time-am' dyc-type='time-am' dyc-cls='hover-time,pressed-time'></div></td>"),c.push("</tr><tr>","<td dyc-type='time-hour-' dyc-cls='hover-time,pressed-time' class='DynarchCalendar-time-down'></td>","<td dyc-type='time-min-' dyc-cls='hover-time,pressed-time' class='DynarchCalendar-time-down'></td>","</tr></table>");}function aN(h){var g=["<table height='100%'",aU,"><tr><td>","<table style='margin-top: 1.5em'",aU,">","<tr><td colspan='3'><input dyc-btn='year' class='DynarchCalendar-menu-year' size='6' value='",h.date.getFullYear(),"' /></td></tr>","<tr><td><div dyc-type='menubtn' dyc-cls='hover-navBtn,pressed-navBtn' dyc-btn='today'>",ao("goToday"),"</div></td></tr>","</table>","<p class='DynarchCalendar-menu-sep'>&nbsp;</p>","<table class='DynarchCalendar-menu-mtable'",aU,">"],l=ao("smn"),k=0,j=g.length,i;while(k<12){g[j++]="<tr>";for(i=4;--i>0;){g[j++]="<td><div dyc-type='menubtn' dyc-cls='hover-navBtn,pressed-navBtn' dyc-btn='m"+k+"' class='DynarchCalendar-menu-month'>"+l[k++]+"</div></td>";}g[j++]="</tr>";}g[j++]="</table></td></tr></table>";return g.join("");}function aO(b){return"<div unselectable='on'>"+ai(b.date,b.args.titleFormat)+"</div>";}function aP(d){var c=["<table class='DynarchCalendar-topCont'",aU,"><tr><td>","<div class='DynarchCalendar'>",a3?"<a class='DynarchCalendar-focusLink' href='#'></a>":"<button class='DynarchCalendar-focusLink'></button>","<div class='DynarchCalendar-topBar'>","<div dyc-type='nav' dyc-btn='-Y' dyc-cls='hover-navBtn,pressed-navBtn' ","class='DynarchCalendar-navBtn DynarchCalendar-prevYear'><div></div></div>","<div dyc-type='nav' dyc-btn='+Y' dyc-cls='hover-navBtn,pressed-navBtn' ","class='DynarchCalendar-navBtn DynarchCalendar-nextYear'><div></div></div>","<div dyc-type='nav' dyc-btn='-M' dyc-cls='hover-navBtn,pressed-navBtn' ","class='DynarchCalendar-navBtn DynarchCalendar-prevMonth'><div></div></div>","<div dyc-type='nav' dyc-btn='+M' dyc-cls='hover-navBtn,pressed-navBtn' ","class='DynarchCalendar-navBtn DynarchCalendar-nextMonth'><div></div></div>","<table class='DynarchCalendar-titleCont'",aU,"><tr><td>","<div dyc-type='title' dyc-btn='menu' dyc-cls='hover-title,pressed-title' class='DynarchCalendar-title'>",aO(d),"</div></td></tr></table>","<div class='DynarchCalendar-dayNames'>",aR(d),"</div>","</div>","<div class='DynarchCalendar-body'></div>"];(d.args.bottomBar||d.args.showTime)&&c.push("<div class='DynarchCalendar-bottomBar'>",aL(d),"</div>"),c.push("<div class='DynarchCalendar-menu' style='display: none'>",aN(d),"</div>","<div class='DynarchCalendar-tooltip'></div>","</div>","</td></tr></table>");return c.join("");}function aQ(N,M,L){M=M||N.date,L=L||N.fdow,M=new Date(M.getFullYear(),M.getMonth(),M.getDate(),12,0,0,0);var K=M.getMonth(),J=[],I=0,H=N.args.weekNumbers;M.setDate(1);var G=(M.getDay()-L)%7;G<0&&(G+=7),M.setDate(0-G),M.setDate(M.getDate()+1);var F=new Date,E=F.getDate(),D=F.getMonth(),C=F.getFullYear();J[I++]="<table class='DynarchCalendar-bodyTable'"+aU+">";for(var B=0;B<6;++B){J[I++]="<tr class='DynarchCalendar-week",B==0&&(J[I++]=" DynarchCalendar-first-row"),B==5&&(J[I++]=" DynarchCalendar-last-row"),J[I++]="'>",H&&(J[I++]="<td class='DynarchCalendar-first-col'><div class='DynarchCalendar-weekNumber'>"+an(M)+"</div></td>");for(var A=0;A<7;++A){var z=M.getDate(),y=M.getMonth(),x=M.getFullYear(),w=10000*x+100*(y+1)+z,v=N.selection.isSelected(w),j=N.isDisabled(M);J[I++]="<td class='",A==0&&!H&&(J[I++]=" DynarchCalendar-first-col"),A==0&&B==0&&(N._firstDateVisible=w),A==6&&(J[I++]=" DynarchCalendar-last-col",B==5&&(N._lastDateVisible=w)),v&&(J[I++]=" DynarchCalendar-td-selected"),J[I++]="'><div dyc-type='date' unselectable='on' dyc-date='"+w+"' ",j&&(J[I++]="disabled='1' "),J[I++]="class='DynarchCalendar-day",ao("weekend").indexOf(M.getDay())>=0&&(J[I++]=" DynarchCalendar-weekend"),y!=K&&(J[I++]=" DynarchCalendar-day-othermonth"),z==E&&y==D&&x==C&&(J[I++]=" DynarchCalendar-day-today"),j&&(J[I++]=" DynarchCalendar-day-disabled"),v&&(J[I++]=" DynarchCalendar-day-selected"),j=N.args.dateInfo(M),j&&j.klass&&(J[I++]=" "+j.klass),J[I++]="'>"+z+"</div></td>",M=new Date(x,y,z+1,12,0,0,0);}J[I++]="</tr>";}J[I++]="</table>";return J.join("");}function aR(f){var e=["<table",aU,"><tr>"],h=0;f.args.weekNumbers&&e.push("<td><div class='DynarchCalendar-weekNumber'>",ao("wk"),"</div></td>");while(h<7){var g=(h+++f.fdow)%7;e.push("<td><div",ao("weekend").indexOf(g)>=0?" class='DynarchCalendar-weekend'>":">",ao("sdn")[g],"</div></td>");}e.push("</tr></table>");return e.join("");}function bo(a){a=a||{},this.args=a=af(a,{animation:!a1,cont:null,bottomBar:!0,date:!0,fdow:ao("fdow"),min:null,max:null,reverseWheel:!1,selection:[],selectionType:bo.SEL_SINGLE,weekNumbers:!1,align:"Bl/ / /T/r",inputField:null,trigger:null,dateFormat:"%Y-%m-%d",fixed:!1,opacity:a3?1:3,titleFormat:"%b %Y",showTime:!1,timePos:"right",time:!0,minuteStep:5,noScroll:!1,disabled:aT,checkRange:!1,dateInfo:aT,onChange:aT,onSelect:aT,onTimeChange:aT,onFocus:aT,onBlur:aT}),this.handlers={};var h=this,f=new Date;a.min=ah(a.min),a.max=ah(a.max),a.date===!0&&(a.date=f),a.time===!0&&(a.time=f.getHours()*100+Math.floor(f.getMinutes()/a.minuteStep)*a.minuteStep),this.date=ah(a.date),this.time=a.time,this.fdow=a.fdow,aW("onChange onSelect onTimeChange onFocus onBlur".split(/\s+/),function(b){var c=a[b];c instanceof Array||(c=[c]),h.handlers[b]=c;}),this.selection=new bo.Selection(a.selection,a.selectionType,au,this);var e=aJ(this);a.cont&&aS(a.cont).appendChild(e),a.trigger&&this.manageFields(a.trigger,a.inputField,a.dateFormat);}var a9=navigator.userAgent,a8=/opera/i.test(a9),a5=/Konqueror|Safari|KHTML/i.test(a9),a3=/msie/i.test(a9)&&!a8&&!/mac_powerpc/i.test(a9),a1=a3&&/msie 6/i.test(a9),aZ=/gecko/i.test(a9)&&!a5&&!a8&&!a3,aX=bo.prototype,aV=bo.I18N={};bo.SEL_NONE=0,bo.SEL_SINGLE=1,bo.SEL_MULTIPLE=2,bo.SEL_WEEK=3,bo.dateToInt=al,bo.intToDate=ak,bo.printDate=ai,bo.formatString=ap,bo.i18n=ao,bo.LANG=function(e,d,f){aV.__=aV[e]={name:d,data:f};},bo.setup=function(a){return new bo(a);},aX.moveTo=function(N,M){var L=this;N=ah(N);var K=aj(N,L.date,!0),J,I=L.args,H=I.min&&aj(N,I.min),G=I.max&&aj(N,I.max);I.animation||(M=!1),aB(H!=null&&H<=1,[L.els.navPrevMonth,L.els.navPrevYear],"DynarchCalendar-navDisabled"),aB(G!=null&&G>=-1,[L.els.navNextMonth,L.els.navNextYear],"DynarchCalendar-navDisabled"),H<-1&&(N=I.min,J=1,K=0),G>1&&(N=I.max,J=2,K=0),L.date=N,L.refresh(!!M),L.callHooks("onChange",L,N,M);if(M&&(K!=0||M!=2)){L._bodyAnim&&L._bodyAnim.stop();var F=L.els.body,E=br("div","DynarchCalendar-animBody-"+aE[K],F),D=F.firstChild,C=a6(D)||0.7,B=J?a7.brakes:K==0?a7.shake:a7.accel_ab2,A=K*K>4,z=A?D.offsetTop:D.offsetLeft,y=E.style,x=A?F.offsetHeight:F.offsetWidth;K<0?x+=z:K>0?x=z-x:(x=Math.round(x/7),J==2&&(x=-x));if(!J&&K!=0){var w=E.cloneNode(!0),v=w.style,l=2*x;w.appendChild(D.cloneNode(!0)),v[A?"marginTop":"marginLeft"]=x+"px",F.appendChild(w);}D.style.visibility="hidden",E.innerHTML=aQ(L),L._bodyAnim=bn({onUpdate:function(d,c){var h=B(d);if(w){var e=c(h,x,l)+"px";}if(J){y[A?"marginTop":"marginLeft"]=c(h,x,0)+"px";}else{if(A||K==0){y.marginTop=c(K==0?B(d*d):h,0,x)+"px",K!=0&&(v.marginTop=e);}if(!A||K==0){y.marginLeft=c(h,0,x)+"px",K!=0&&(v.marginLeft=e);}}L.args.opacity>2&&w&&(a6(w,1-h),a6(E,h));},onStop:function(a){F.innerHTML=aQ(L,N),L._bodyAnim=null;}});}L._lastHoverDate=null;return H>=-1&&G<=1;},aX.isDisabled=function(d){var c=this.args;return c.min&&aj(d,c.min)<0||c.max&&aj(d,c.max)>0||c.disabled(d);},aX.toggleMenu=function(){aC(this,!this._menuVisible);},aX.refresh=function(d){var c=this.els;d||(c.body.innerHTML=aQ(this)),c.title.innerHTML=aO(this),c.yearInput.value=this.date.getFullYear();},aX.redraw=function(){var d=this,c=d.els;d.refresh(),c.dayNames.innerHTML=aR(d),c.menu.innerHTML=aN(d),c.bottomBar&&(c.bottomBar.innerHTML=aL(d)),bp(c.topCont,function(b){var a=aK[b.className];a&&(c[a]=b),b.className=="DynarchCalendar-menu-year"?(ae(b,d._focusEvents),c.yearInput=b):a3&&b.setAttribute("unselectable","on");}),d.setTime(null,!0);},aX.setLanguage=function(a){var d=bo.setLanguage(a);d&&(this.fdow=d.data.fdow,this.redraw());},bo.setLanguage=function(d){var c=aV[d];c&&(aV.__=c);return c;},aX.focus=function(){try{this.els[this._menuVisible?"yearInput":"focusLink"].focus();}catch(b){}aI.call(this);},aX.blur=function(){this.els.focusLink.blur(),this.els.yearInput.blur(),aH.call(this);},aX.showAt=function(j,i,p){this._showAnim&&this._showAnim.stop(),p=p&&this.args.animation;var o=this.els.topCont,n=this,m=this.els.body.firstChild,l=m.offsetHeight,k=o.style;k.position="absolute",k.left=j+"px",k.top=i+"px",k.zIndex=10000,k.display="",p&&(m.style.marginTop=-l+"px",this.args.opacity>1&&a6(o,0),this._showAnim=bn({onUpdate:function(d,c){m.style.marginTop=-c(a7.accel_b(d),l,0)+"px",n.args.opacity>1&&a6(o,d);},onStop:function(){n.args.opacity>1&&a6(o,""),n._showAnim=null;}}));},aX.hide=function(){var g=this.els.topCont,f=this,j=this.els.body.firstChild,i=j.offsetHeight,h=a0(g).y;this.args.animation?(this._showAnim&&this._showAnim.stop(),this._showAnim=bn({onUpdate:function(b,a){f.args.opacity>1&&a6(g,1-b),j.style.marginTop=-a(a7.accel_b(b),0,i)+"px",g.style.top=a(a7.accel_ab(b),h,h-10)+"px";},onStop:function(){g.style.display="none",j.style.marginTop="",f.args.opacity>1&&a6(g,""),f._showAnim=null;}})):g.style.display="none",this.inputField=null;},aX.popup=function(r,q){function k(a){var d={x:j.x,y:j.y};if(!a){return d;}/B/.test(a)&&(d.y+=r.offsetHeight),/b/.test(a)&&(d.y+=r.offsetHeight-m.y),/T/.test(a)&&(d.y-=m.y),/l/.test(a)&&(d.x-=m.x-r.offsetWidth),/L/.test(a)&&(d.x-=m.x),/R/.test(a)&&(d.x+=r.offsetWidth),/c/i.test(a)&&(d.x+=(r.offsetWidth-m.x)/2),/m/i.test(a)&&(d.y+=(r.offsetHeight-m.y)/2);return d;}r=aS(r),q||(q=this.args.align),q=q.split(/\x2f/);var p=a0(r),o=this.els.topCont,n=o.style,m,l=aY();n.visibility="hidden",n.display="",this.showAt(0,0),document.body.appendChild(o),m={x:o.offsetWidth,y:o.offsetHeight};var j=p;j=k(q[0]),j.y<l.y&&(j.y=p.y,j=k(q[1])),j.x+m.x>l.x+l.w&&(j.x=p.x,j=k(q[2])),j.y+m.y>l.y+l.h&&(j.y=p.y,j=k(q[3])),j.x<l.x&&(j.x=p.x,j=k(q[4])),this.showAt(j.x,j.y,!0),n.visibility="",this.focus();},aX.manageFields=function(a,h,g){var f=this;h=aS(h),a=aS(a),/^button$/i.test(a.tagName)&&a.setAttribute("type","button"),ae(a,"click",function(){f.inputField=h,f.dateFormat=g;if(f.selection.type==bo.SEL_SINGLE){var e,d,c,b;e=/input|textarea/i.test(h.tagName)?h.value:h.innerText||h.textContent,e&&(d=/(^|[^%])%[bBmo]/.exec(g),c=/(^|[^%])%[de]/.exec(g),d&&c&&(b=d.index<c.index),e=Calendar.parseDate(e,b),e&&(f.selection.set(e,!1,!0),f.args.showTime&&(f.setHours(e.getHours()),f.setMinutes(e.getMinutes())),f.moveTo(e)));}f.popup(a);});},aX.callHooks=function(f){var e=bs(arguments,1),h=this.handlers[f],g=0;for(;g<h.length;++g){h[g].apply(this,e);}},aX.addEventListener=function(d,c){this.handlers[d].push(c);},aX.removeEventListener=function(f,e){var h=this.handlers[f],g=h.length;while(--g>=0){h[g]===e&&h.splice(g,1);}},aX.getTime=function(){return this.time;},aX.setTime=function(g,f){if(this.args.showTime){g=g!=null?g:this.time,this.time=g;var j=this.getHours(),i=this.getMinutes(),h=j<12;this.args.showTime==12&&(j==0&&(j=12),j>12&&(j-=12),this.els.timeAM.innerHTML=ao(h?"AM":"PM")),j<10&&(j="0"+j),i<10&&(i="0"+i),this.els.timeHour.innerHTML=j,this.els.timeMinute.innerHTML=i,f||this.callHooks("onTimeChange",this,g);}},aX.getHours=function(){return Math.floor(this.time/100);},aX.getMinutes=function(){return this.time%100;},aX.setHours=function(b){b<0&&(b+=24),this.setTime(100*(b%24)+this.time%100);},aX.setMinutes=function(b){b<0&&(b+=60),b=Math.floor(b/this.args.minuteStep)*this.args.minuteStep,this.setTime(100*this.getHours()+b%60);},aX._getInputYear=function(){var b=parseInt(this.els.yearInput.value,10);isNaN(b)&&(b=this.date.getFullYear());return b;},aX._showTooltip=function(f){var e="",h,g=this.els.tooltip;f&&(f=ak(f),h=this.args.dateInfo(f),h&&h.tooltip&&(e="<div class='DynarchCalendar-tooltipCont'>"+ai(f,h.tooltip)+"</div>")),g.innerHTML=e;};var aU=" align='center' cellspacing='0' cellpadding='0'",aK={"DynarchCalendar-topCont":"topCont","DynarchCalendar-focusLink":"focusLink",DynarchCalendar:"main","DynarchCalendar-topBar":"topBar","DynarchCalendar-title":"title","DynarchCalendar-dayNames":"dayNames","DynarchCalendar-body":"body","DynarchCalendar-menu":"menu","DynarchCalendar-menu-year":"yearInput","DynarchCalendar-bottomBar":"bottomBar","DynarchCalendar-tooltip":"tooltip","DynarchCalendar-time-hour":"timeHour","DynarchCalendar-time-minute":"timeMinute","DynarchCalendar-time-am":"timeAM","DynarchCalendar-navBtn DynarchCalendar-prevYear":"navPrevYear","DynarchCalendar-navBtn DynarchCalendar-nextYear":"navNextYear","DynarchCalendar-navBtn DynarchCalendar-prevMonth":"navPrevMonth","DynarchCalendar-navBtn DynarchCalendar-nextMonth":"navNextMonth"},aE={"-3":"backYear","-2":"back",0:"now",2:"fwd",3:"fwdYear"},at={37:-1,38:-2,39:1,40:2},ar={33:-1,34:1};aX._getDateDiv=function(e){var d=null;if(e){try{bp(this.els.body,function(a){if(a.getAttribute("dyc-date")==e){throw d=a;}});}catch(f){}}return d;},(bo.Selection=function(f,e,h,g){this.type=e,this.sel=f instanceof Array?f:[f],this.onChange=bq(h,g),this.cal=g;}).prototype={get:function(){return this.type==bo.SEL_SINGLE?this.sel[0]:this.sel;},isEmpty:function(){return this.sel.length==0;},set:function(a,h,g){var f=this.type==bo.SEL_SINGLE;a instanceof Array?(this.sel=a,this.normalize(),g||this.onChange(this)):(a=al(a),f||!this.isSelected(a)?(f?this.sel=[a]:this.sel.splice(this.findInsertPos(a),0,a),this.normalize(),g||this.onChange(this)):h&&this.unselect(a,g));},reset:function(){this.sel=[],this.set.apply(this,arguments);},countDays:function(){var h=0,g=this.sel,l=g.length,k,j,i;while(--l>=0){k=g[l],k instanceof Array&&(j=ak(k[0]),i=ak(k[1]),h+=Math.round(Math.abs(i.getTime()-j.getTime())/86400000)),++h;}return h;},unselect:function(r,q){r=al(r);var p=!1;for(var o=this.sel,n=o.length,m;--n>=0;){m=o[n];if(m instanceof Array){if(r>=m[0]&&r<=m[1]){var l=ak(r),k=l.getDate();if(r==m[0]){l.setDate(k+1),m[0]=al(l),p=!0;}else{if(r==m[1]){l.setDate(k-1),m[1]=al(l),p=!0;}else{var j=new Date(l);j.setDate(k+1),l.setDate(k-1),o.splice(n+1,0,[al(j),m[1]]),m[1]=al(l),p=!0;}}}}else{r==m&&(o.splice(n,1),p=!0);}}p&&(this.normalize(),q||this.onChange(this));},normalize:function(){this.sel=this.sel.sort(function(d,c){d instanceof Array&&(d=d[0]),c instanceof Array&&(c=c[0]);return d-c;});for(var i=this.sel,h=i.length,n,m;--h>=0;){n=i[h];if(n instanceof Array){if(n[0]>n[1]){i.splice(h,1);continue;}n[0]==n[1]&&(n=i[h]=n[0]);}if(m){var l=m,k=n instanceof Array?n[1]:n;k=ak(k),k.setDate(k.getDate()+1),k=al(k);if(k>=l){var j=i[h+1];n instanceof Array&&j instanceof Array?(n[1]=j[1],i.splice(h+1,1)):n instanceof Array?(n[1]=m,i.splice(h+1,1)):j instanceof Array?(j[0]=n,i.splice(h,1)):(i[h]=[n,j],i.splice(h+1,1));}}m=n instanceof Array?n[0]:n;}},findInsertPos:function(f){for(var e=this.sel,h=e.length,g;--h>=0;){g=e[h],g instanceof Array&&(g=g[0]);if(g<=f){break;}}return h+1;},clear:function(b){this.sel=[],b||this.onChange(this);},selectRange:function(a,j){a=al(a),j=al(j);if(a>j){var i=a;a=j,j=i;}var h=this.cal.args.checkRange;if(!h){return this._do_selectRange(a,j);}try{aW((new bo.Selection([[a,j]],bo.SEL_MULTIPLE,aT)).getDates(),bq(function(b){if(this.isDisabled(b)){h instanceof Function&&h(b,this);throw"OUT";}},this.cal)),this._do_selectRange(a,j);}catch(g){}},_do_selectRange:function(d,c){this.sel.push([d,c]),this.normalize(),this.onChange(this);},isSelected:function(e){for(var d=this.sel.length,f;--d>=0;){f=this.sel[d];if(f instanceof Array&&e>=f[0]&&e<=f[1]||e==f){return !0;}}return !1;},getFirstDate:function(){var b=this.sel[0];b&&b instanceof Array&&(b=b[0]);return b;},getLastDate:function(){if(this.sel.length>0){var b=this.sel[this.sel.length-1];b&&b instanceof Array&&(b=b[1]);return b;}},print:function(i,h){var n=[],m=0,l,k=this.cal.getHours(),j=this.cal.getMinutes();h||(h=" -> ");while(m<this.sel.length){l=this.sel[m++],l instanceof Array?n.push(ai(ak(l[0],k,j),i)+h+ai(ak(l[1],k,j),i)):n.push(ai(ak(l,k,j),i));}return n;},getDates:function(g){var f=[],j=0,i,h;while(j<this.sel.length){h=this.sel[j++];if(h instanceof Array){i=ak(h[0]),h=h[1];while(al(i)<h){f.push(g?ai(i,g):new Date(i)),i.setDate(i.getDate()+1);}}else{i=ak(h);}f.push(g?ai(i,g):i);}return f;}},bo.isUnicodeLetter=function(b){return b.toUpperCase()!=b.toLowerCase();},bo.parseDate=function(B,A,z){if(!/\S/.test(B)){return"";}B=B.replace(/^\s+/,"").replace(/\s+$/,""),z=z||new Date;var y=null,x=null,w=null,v=null,u=null,t=null,s=B.match(/([0-9]{1,2}):([0-9]{1,2})(:[0-9]{1,2})?\s*(am|pm)?/i);s&&(v=parseInt(s[1],10),u=parseInt(s[2],10),t=s[3]?parseInt(s[3].substr(1),10):0,B=B.substring(0,s.index)+B.substr(s.index+s[0].length),s[4]&&(s[4].toLowerCase()=="pm"&&v<12?v+=12:s[4].toLowerCase()=="am"&&v>=12&&(v-=12)));var r=function(){function b(c){E.push(c);}function l(){var c="";while(o()&&/[0-9]/.test(o())){c+=C();}if(n(o())){return m(c);}return parseInt(c,10);}function m(c){while(o()&&n(o())){c+=C();}return c;}function o(){return B.charAt(F);}function C(){return B.charAt(F++);}var F=0,E=[],D,n=bo.isUnicodeLetter;while(F<B.length){D=o(),n(D)?b(m("")):/[0-9]/.test(D)?b(l()):C();}return E;}(),q=[];for(var p=0;p<r.length;++p){var a=r[p];/^[0-9]{4}$/.test(a)?(y=parseInt(a,10),x==null&&w==null&&A==null&&(A=!0)):/^[0-9]{1,2}$/.test(a)?(a=parseInt(a,10),a<60?a<0||a>12?a>=1&&a<=31&&(w=a):q.push(a):y=a):x==null&&(x=ag(a));}q.length<2?q.length==1&&(w==null?w=q.shift():x==null&&(x=q.shift())):A?(x==null&&(x=q.shift()),w==null&&(w=q.shift())):(w==null&&(w=q.shift()),x==null&&(x=q.shift())),y==null&&(y=q.length>0?q.shift():z.getFullYear()),y<30?y+=2000:y<99&&(y+=1900),x==null&&(x=z.getMonth()+1);return y!=null&&x!=null&&w!=null?new Date(y,x-1,w,v,u,t):null;};var a7={elastic_b:function(b){return 1-Math.cos(-b*5.5*Math.PI)/Math.pow(2,7*b);},magnetic:function(b){return 1-Math.cos(b*b*b*10.5*Math.PI)/Math.exp(4*b);},accel_b:function(b){b=1-b;return 1-b*b*b*b;},accel_a:function(b){return b*b*b;},accel_ab:function(b){b=1-b;return 1-Math.sin(b*b*Math.PI/2);},accel_ab2:function(b){return(b/=0.5)<1?0.5*b*b:-0.5*(--b*(b-2)-1);},brakes:function(b){b=1-b;return 1-Math.sin(b*b*Math.PI);},shake:function(b){return b<0.5?-Math.cos(b*11*Math.PI)*b*b:(b=1-b,Math.cos(b*11*Math.PI)*b*b);}},aT=new Function;return bo;}();